{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{jsx as _jsx}from\"react/jsx-runtime\";import React,{useState}from\"react\";import{API}from\"aws-amplify\";import{useHistory}from\"react-router-dom\";import{Elements}from\"@stripe/react-stripe-js\";import{loadStripe}from'@stripe/stripe-js';import BillingForm from\"../components/BillingForm\";import{onError}from\"../libs/errorLib\";import config from\"../config\";import\"./Settings.css\";export default function Settings(){var history=useHistory();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var stripePromise=loadStripe(config.STRIPE_KEY);function billUser(details){return API.post(\"notes\",\"/billing\",{body:details});}function handleFormSubmit(_x,_x2){return _handleFormSubmit.apply(this,arguments);}function _handleFormSubmit(){_handleFormSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(storage,_ref){var token,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=_ref.token,error=_ref.error;if(!error){_context.next=4;break;}onError(error);return _context.abrupt(\"return\");case 4:setIsLoading(true);_context.prev=5;_context.next=8;return billUser({storage:storage,source:token.id});case 8:alert(\"Your card has been charged successfully!\");history.push(\"/\");_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](5);onError(_context.t0);setIsLoading(false);case 16:case\"end\":return _context.stop();}}},_callee,null,[[5,12]]);}));return _handleFormSubmit.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{className:\"Settings\",children:/*#__PURE__*/_jsx(Elements,{fonts:[{cssSrc:\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800\"}],stripe:stripePromise,children:/*#__PURE__*/_jsx(BillingForm,{isLoading:isLoading,onSubmit:handleFormSubmit})})});}","map":{"version":3,"sources":["/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/src/containers/Settings.js"],"names":["React","useState","API","useHistory","Elements","loadStripe","BillingForm","onError","config","Settings","history","isLoading","setIsLoading","stripePromise","STRIPE_KEY","billUser","details","post","body","handleFormSubmit","storage","token","error","source","id","alert","push","cssSrc"],"mappings":"kmBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,QAAT,KAAyB,yBAAzB,CACA,OAASC,UAAT,KAA2B,mBAA3B,CACA,MAAOC,CAAAA,WAAP,KAAwB,2BAAxB,CACA,OAASC,OAAT,KAAwB,kBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CACA,MAAO,gBAAP,CAEA,cAAe,SAASC,CAAAA,QAAT,EAAoB,CACjC,GAAMC,CAAAA,OAAO,CAAGP,UAAU,EAA1B,CADiC,cAECF,QAAQ,CAAC,KAAD,CAFT,wCAE1BU,SAF0B,eAEfC,YAFe,eAGjC,GAAMC,CAAAA,aAAa,CAAGR,UAAU,CAACG,MAAM,CAACM,UAAR,CAAhC,CAEA,QAASC,CAAAA,QAAT,CAAkBC,OAAlB,CAA2B,CACzB,MAAOd,CAAAA,GAAG,CAACe,IAAJ,CAAS,OAAT,CAAkB,UAAlB,CAA8B,CACnCC,IAAI,CAAEF,OAD6B,CAA9B,CAAP,CAGD,CATgC,QAWlBG,CAAAA,gBAXkB,gKAWjC,iBAAgCC,OAAhC,uIAA2CC,KAA3C,MAA2CA,KAA3C,CAAkDC,KAAlD,MAAkDA,KAAlD,KACMA,KADN,yBAEIf,OAAO,CAACe,KAAD,CAAP,CAFJ,wCAMEV,YAAY,CAAC,IAAD,CAAZ,CANF,sCASUG,CAAAA,QAAQ,CAAC,CACbK,OAAO,CAAPA,OADa,CAEbG,MAAM,CAAEF,KAAK,CAACG,EAFD,CAAD,CATlB,QAcIC,KAAK,CAAC,0CAAD,CAAL,CACAf,OAAO,CAACgB,IAAR,CAAa,GAAb,EAfJ,iFAiBInB,OAAO,aAAP,CACAK,YAAY,CAAC,KAAD,CAAZ,CAlBJ,qEAXiC,mDAiCjC,mBACE,YAAK,SAAS,CAAC,UAAf,uBACI,KAAC,QAAD,EACE,KAAK,CAAE,CACL,CACEe,MAAM,CACJ,uEAFJ,CADK,CADT,CAOE,MAAM,CAAEd,aAPV,uBASE,KAAC,WAAD,EAAa,SAAS,CAAEF,SAAxB,CAAmC,QAAQ,CAAEQ,gBAA7C,EATF,EADJ,EADF,CAeD","sourcesContent":["import React, { useState } from \"react\";\nimport { API } from \"aws-amplify\";\nimport { useHistory } from \"react-router-dom\";\nimport { Elements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from '@stripe/stripe-js';\nimport BillingForm from \"../components/BillingForm\";\nimport { onError } from \"../libs/errorLib\";\nimport config from \"../config\";\nimport \"./Settings.css\";\n\nexport default function Settings() {\n  const history = useHistory();\n  const [isLoading, setIsLoading] = useState(false);\n  const stripePromise = loadStripe(config.STRIPE_KEY);\n\n  function billUser(details) {\n    return API.post(\"notes\", \"/billing\", {\n      body: details\n    });\n  }\n\n  async function handleFormSubmit(storage, { token, error }) {\n    if (error) {\n      onError(error);\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      await billUser({\n        storage,\n        source: token.id\n      });\n\n      alert(\"Your card has been charged successfully!\");\n      history.push(\"/\");\n    } catch (e) {\n      onError(e);\n      setIsLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"Settings\">\n        <Elements\n          fonts={[\n            {\n              cssSrc:\n                \"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800\",\n            },\n          ]}\n          stripe={stripePromise}\n        >\n          <BillingForm isLoading={isLoading} onSubmit={handleFormSubmit} />\n        </Elements>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}