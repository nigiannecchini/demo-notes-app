{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React,{useState,useEffect}from\"react\";import{Auth}from\"aws-amplify\";import Nav from\"react-bootstrap/Nav\";import Navbar from\"react-bootstrap/Navbar\";import{useHistory}from\"react-router-dom\";import{LinkContainer}from\"react-router-bootstrap\";import ErrorBoundary from\"./components/ErrorBoundary\";import{AppContext}from\"./libs/contextLib\";import{onError}from\"./libs/errorLib\";import Routes from\"./Routes\";import\"./App.css\";function App(){var history=useHistory();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isAuthenticating=_useState2[0],setIsAuthenticating=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isAuthenticated=_useState4[0],userHasAuthenticated=_useState4[1];useEffect(function(){onLoad();},[]);function onLoad(){return _onLoad.apply(this,arguments);}function _onLoad(){_onLoad=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Auth.currentSession();case 3:userHasAuthenticated(true);_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);if(_context.t0!=='No current user'){onError(_context.t0);}case 9:setIsAuthenticating(false);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return _onLoad.apply(this,arguments);}function handleLogout(){return _handleLogout.apply(this,arguments);}function _handleLogout(){_handleLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return Auth.signOut();case 2:userHasAuthenticated(false);history.push(\"/login\");case 4:case\"end\":return _context2.stop();}}},_callee2);}));return _handleLogout.apply(this,arguments);}return!isAuthenticating&&/*#__PURE__*/_jsxs(\"div\",{className:\"App container py-3\",children:[/*#__PURE__*/_jsxs(Navbar,{collapseOnSelect:true,bg:\"light\",expand:\"md\",className:\"mb-3\",children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/\",children:/*#__PURE__*/_jsx(Navbar.Brand,{className:\"font-weight-bold text-muted\",children:\"Scratch\"})}),/*#__PURE__*/_jsx(Navbar.Toggle,{}),/*#__PURE__*/_jsx(Navbar.Collapse,{className:\"justify-content-end\",children:/*#__PURE__*/_jsx(Nav,{activeKey:window.location.pathname,children:isAuthenticated?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/settings\",children:/*#__PURE__*/_jsx(Nav.Link,{children:\"Settings\"})}),/*#__PURE__*/_jsx(Nav.Link,{onClick:handleLogout,children:\"Logout\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(LinkContainer,{to:\"/signup\",children:/*#__PURE__*/_jsx(Nav.Link,{children:\"Signup\"})}),/*#__PURE__*/_jsx(LinkContainer,{to:\"/login\",children:/*#__PURE__*/_jsx(Nav.Link,{children:\"Login\"})})]})})})]}),/*#__PURE__*/_jsx(ErrorBoundary,{children:/*#__PURE__*/_jsx(AppContext.Provider,{value:{isAuthenticated:isAuthenticated,userHasAuthenticated:userHasAuthenticated},children:/*#__PURE__*/_jsx(Routes,{})})})]});}export default App;","map":{"version":3,"sources":["/Users/ngiannecchin/MercadoLivre/Projetos/Nilo/serveless/notes/frontend/src/App.js"],"names":["React","useState","useEffect","Auth","Nav","Navbar","useHistory","LinkContainer","ErrorBoundary","AppContext","onError","Routes","App","history","isAuthenticating","setIsAuthenticating","isAuthenticated","userHasAuthenticated","onLoad","currentSession","handleLogout","signOut","push","window","location","pathname"],"mappings":"osBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,IAAT,KAAqB,aAArB,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA,MAAOC,CAAAA,MAAP,KAAmB,wBAAnB,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,aAAT,KAA8B,wBAA9B,CACA,MAAOC,CAAAA,aAAP,KAA0B,4BAA1B,CACA,OAASC,UAAT,KAA2B,mBAA3B,CACA,OAASC,OAAT,KAAwB,iBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,UAAnB,CACA,MAAO,WAAP,CAEA,QAASC,CAAAA,GAAT,EAAe,CACb,GAAMC,CAAAA,OAAO,CAAGP,UAAU,EAA1B,CADa,cAEmCL,QAAQ,CAAC,IAAD,CAF3C,wCAENa,gBAFM,eAEYC,mBAFZ,8BAGmCd,QAAQ,CAAC,KAAD,CAH3C,yCAGNe,eAHM,eAGWC,oBAHX,eAKbf,SAAS,CAAC,UAAM,CACdgB,MAAM,GACP,CAFQ,CAEN,EAFM,CAAT,CALa,QASEA,CAAAA,MATF,4HASb,yKAEUf,CAAAA,IAAI,CAACgB,cAAL,EAFV,QAGIF,oBAAoB,CAAC,IAAD,CAApB,CAHJ,8EAMI,GAAI,cAAM,iBAAV,CAA6B,CAC3BP,OAAO,aAAP,CACD,CARL,OAWEK,mBAAmB,CAAC,KAAD,CAAnB,CAXF,oEATa,iDAuBEK,CAAAA,YAvBF,8IAuBb,+JACQjB,CAAAA,IAAI,CAACkB,OAAL,EADR,QAGEJ,oBAAoB,CAAC,KAAD,CAApB,CAEAJ,OAAO,CAACS,IAAR,CAAa,QAAb,EALF,wDAvBa,+CA+Bb,MACE,CAACR,gBAAD,eACE,aAAK,SAAS,CAAC,oBAAf,wBACE,MAAC,MAAD,EAAQ,gBAAgB,KAAxB,CAAyB,EAAE,CAAC,OAA5B,CAAoC,MAAM,CAAC,IAA3C,CAAgD,SAAS,CAAC,MAA1D,wBACE,KAAC,aAAD,EAAe,EAAE,CAAC,GAAlB,uBACE,KAAC,MAAD,CAAQ,KAAR,EAAc,SAAS,CAAC,6BAAxB,qBADF,EADF,cAME,KAAC,MAAD,CAAQ,MAAR,IANF,cAOE,KAAC,MAAD,CAAQ,QAAR,EAAiB,SAAS,CAAC,qBAA3B,uBACE,KAAC,GAAD,EAAK,SAAS,CAAES,MAAM,CAACC,QAAP,CAAgBC,QAAhC,UACGT,eAAe,cACd,wCACE,KAAC,aAAD,EAAe,EAAE,CAAC,WAAlB,uBACE,KAAC,GAAD,CAAK,IAAL,uBADF,EADF,cAIE,KAAC,GAAD,CAAK,IAAL,EAAU,OAAO,CAAEI,YAAnB,oBAJF,GADc,cAQd,wCACE,KAAC,aAAD,EAAe,EAAE,CAAC,SAAlB,uBACE,KAAC,GAAD,CAAK,IAAL,qBADF,EADF,cAIE,KAAC,aAAD,EAAe,EAAE,CAAC,QAAlB,uBACE,KAAC,GAAD,CAAK,IAAL,oBADF,EAJF,GATJ,EADF,EAPF,GADF,cA8BE,KAAC,aAAD,wBACE,KAAC,UAAD,CAAY,QAAZ,EAAqB,KAAK,CAAE,CAAEJ,eAAe,CAAfA,eAAF,CAAmBC,oBAAoB,CAApBA,oBAAnB,CAA5B,uBACE,KAAC,MAAD,IADF,EADF,EA9BF,GAFJ,CAwCD,CAED,cAAeL,CAAAA,GAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Auth } from \"aws-amplify\";\nimport Nav from \"react-bootstrap/Nav\";\nimport Navbar from \"react-bootstrap/Navbar\";\nimport { useHistory } from \"react-router-dom\";\nimport { LinkContainer } from \"react-router-bootstrap\";\nimport ErrorBoundary from \"./components/ErrorBoundary\";\nimport { AppContext } from \"./libs/contextLib\";\nimport { onError } from \"./libs/errorLib\";\nimport Routes from \"./Routes\";\nimport \"./App.css\";\n\nfunction App() {\n  const history = useHistory();\n  const [isAuthenticating, setIsAuthenticating] = useState(true);\n  const [isAuthenticated, userHasAuthenticated] = useState(false);\n\n  useEffect(() => {\n    onLoad();\n  }, []);\n\n  async function onLoad() {\n    try {\n      await Auth.currentSession();\n      userHasAuthenticated(true);\n    }\n    catch(e) {\n      if (e !== 'No current user') {\n        onError(e);\n      }\n    }\n\n    setIsAuthenticating(false);\n  }\n\n  async function handleLogout() {\n    await Auth.signOut();\n\n    userHasAuthenticated(false);\n\n    history.push(\"/login\");\n  }\n\n  return (\n    !isAuthenticating && (\n      <div className=\"App container py-3\">\n        <Navbar collapseOnSelect bg=\"light\" expand=\"md\" className=\"mb-3\">\n          <LinkContainer to=\"/\">\n            <Navbar.Brand className=\"font-weight-bold text-muted\">\n              Scratch\n            </Navbar.Brand>\n          </LinkContainer>\n          <Navbar.Toggle />\n          <Navbar.Collapse className=\"justify-content-end\">\n            <Nav activeKey={window.location.pathname}>\n              {isAuthenticated ? (\n                <>\n                  <LinkContainer to=\"/settings\">\n                    <Nav.Link>Settings</Nav.Link>\n                  </LinkContainer>\n                  <Nav.Link onClick={handleLogout}>Logout</Nav.Link>\n                </>\n              ) : (\n                <>\n                  <LinkContainer to=\"/signup\">\n                    <Nav.Link>Signup</Nav.Link>\n                  </LinkContainer>\n                  <LinkContainer to=\"/login\">\n                    <Nav.Link>Login</Nav.Link>\n                  </LinkContainer>\n                </>\n              )}\n            </Nav>\n          </Navbar.Collapse>\n        </Navbar>\n        <ErrorBoundary>\n          <AppContext.Provider value={{ isAuthenticated, userHasAuthenticated }}>\n            <Routes />\n          </AppContext.Provider>\n        </ErrorBoundary>\n      </div>\n    )\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}